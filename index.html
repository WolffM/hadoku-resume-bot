<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  <title>Resume Bot - Dev</title>
  <script>
    // CRITICAL: Set theme IMMEDIATELY to prevent white flash
    // This runs before any CSS or React code loads
    (function() {
      try {
        // Check sessionStorage first
        const savedTheme = sessionStorage.getItem('hadoku-theme');

        // Then check browser preference
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        // Use saved theme, or fall back to browser preference
        const theme = savedTheme || (prefersDark ? 'dark' : 'light');

        // Apply theme to document root IMMEDIATELY
        document.documentElement.setAttribute('data-theme', theme);

        console.log('[theme-init] Applied initial theme:', theme, {
          savedTheme,
          prefersDark,
          timestamp: new Date().toISOString()
        });
      } catch (err) {
        console.error('[theme-init] Failed to set initial theme:', err);
        // Fallback to light if anything fails
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>
<body>
  <div id="app"></div>
  <script type="module">
    import { mount } from './src/entry.tsx'

    // Get params from URL
    const params = new URLSearchParams(window.location.search)
    const theme = params.get('theme') || 'default'

    console.log('[mount] Mounting resume-bot with:', { theme })

    // Mount the app
    mount(document.getElementById('app'), {
      theme
    })
  </script>
</body>
</html>
